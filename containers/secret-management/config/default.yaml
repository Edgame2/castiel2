# Secret Management Module Configuration
# Default settings - override with environment variables or environment-specific files

module:
  name: secret-management
  version: 1.0.0

server:
  port: ${PORT:-3003}
  host: ${HOST:-0.0.0.0}
  env: ${NODE_ENV:-development}

# Cosmos DB Configuration
cosmos_db:
  endpoint: ${COSMOS_DB_ENDPOINT}
  key: ${COSMOS_DB_KEY}
  database_id: ${COSMOS_DB_DATABASE_ID:-castiel}
  containers:
    secrets: secret_secrets
    vaults: secret_vaults
    audit_logs: secret_audit_logs
    encryption_keys: secret_encryption_keys

# Legacy database.url for backward compatibility (required by schema; use Cosmos in practice)
database:
  url: ${DATABASE_URL:-https://cosmos.placeholder.local}

encryption:
  # Required in production; 64 hex chars. Dev default only for schema/local.
  masterKey: ${SECRET_MASTER_KEY:-0000000000000000000000000000000000000000000000000000000000000000}
  algorithm: AES-256-GCM
  keyRotation:
    enabled: true
    intervalDays: 90

service:
  authToken: ${SERVICE_AUTH_TOKEN:-dev-auth-token}  # Required in production

rabbitmq:
  url: ${RABBITMQ_URL}
  exchange: ${RABBITMQ_EXCHANGE:-coder_events}

logging:
  serviceUrl: ${LOGGING_SERVICE_URL:-http://logging:3014}
  enabled: true
  level: ${LOG_LEVEL:-info}

# Secret Management specific settings
secrets:
  defaultBackend: ${SECRETS_DEFAULT_BACKEND:-LOCAL_ENCRYPTED}
  cache:
    enabled: true
    ttlSeconds: 300
    maxSize: 1000
  softDelete:
    recoveryPeriodDays: 30
  rotation:
    defaultIntervalDays: 90
  expiration:
    notificationDays: [30, 14, 7, 1]

# External service URLs (from config, not hardcoded)
services:
  user_management:
    url: ${USER_MANAGEMENT_URL:-http://localhost:3022}
  logging:
    url: ${LOGGING_SERVICE_URL:-http://localhost:3014}
  notification:
    url: ${NOTIFICATION_SERVICE_URL:-http://localhost:3001}

