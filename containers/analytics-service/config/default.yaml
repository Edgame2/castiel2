# Analytics Service Module Configuration

module:
  name: analytics-service
  version: 1.0.0

server:
  port: ${PORT:-3030}
  host: ${HOST:-0.0.0.0}

cosmos_db:
  endpoint: ${COSMOS_DB_ENDPOINT}
  key: ${COSMOS_DB_KEY}
  database_id: ${COSMOS_DB_DATABASE_ID:-castiel}
  containers:
    events: analytics_events
    metrics: analytics_metrics
    reports: analytics_reports
    quality_metrics: quality_metrics
    quality_anomalies: quality_anomalies
    ai_analytics_events: ai_analytics_events
    ai_analytics_models: ai_analytics_models
    signal_intelligence_signals: signal_intelligence_signals
    # Usage tracking for billing (Plan §10, §3.5): ml.prediction.completed, llm.inference.completed, embedding.generated
    usage_ml: analytics_usage_ml

services:
  shard_manager:
    url: ${SHARD_MANAGER_URL:-http://localhost:3023}
  logging:
    url: ${LOGGING_URL:-http://localhost:3014}
  user_management:
    url: ${USER_MANAGEMENT_URL:-http://localhost:3022}
  ai_service:
    url: ${AI_SERVICE_URL:-http://localhost:3006}
  ml_service:
    url: ${ML_SERVICE_URL:-http://localhost:3031}
  integration_manager:
    url: ${INTEGRATION_MANAGER_URL:-http://localhost:3010}

rabbitmq:
  url: ${RABBITMQ_URL}
  exchange: coder_events
  queue: analytics_service
  # Usage tracking (Plan §10): consumer for ml.prediction.completed, llm.inference.completed, embedding.generated → Cosmos analytics_usage_ml
  bindings:
    - "ml.prediction.completed"
    - "llm.inference.completed"
    - "embedding.generated"

